<html>
<head>
<style type="text/css">
@import "jquery.svg.css";

ul.nav \{
    list-style:none;
    margin:0;
    padding:0;
\}

ul.nav li \{
    display:inline;
\}

ul.nav li a \{
    padding:3px 5px;
    background-color:#ccc;
    color:#000;
    text-decoration:none;
\}

ul.nav li a.selected, ul.nav li a:hover \{
    background-color:#333;
    color:#fff;padding-top:7px;
\}

ul.nav li a:focus \{
    outline:0;
\}

div.svgview \{
    width: 100%;
    height: 80%;
    border: 1px solid #484;
\}
</style>
<script type="text/javascript" src="jquery/jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="jquery/jquery.svg.js"></script>
</head>
<body>
<div class="tabs">
    <ul class="nav">
	<li><a href="#view1"><span>View #1</span></a></li>
	<li><a href="#view2"><span>View #2</span></a></li>
    </ul>
{
    foreach my $id (sort keys %views) {
	$OUT .= "<div class=\"svgview\" id=\"$id\"></div>\n";
    }
}
</div>
<div><textarea style="width: 100%; height: 15%" id="log"></textarea></div>
<script>
$(function () \{
    var tabDivs = $('div.tabs > div');

    $('div.tabs ul.nav a').click(function () \{
        tabDivs.hide().filter(this.hash).show();

        $('div.tabs ul.tabNavigation a').removeClass('selected');
        $(this).addClass('selected');

        return false;
    \}).filter(':first').click();
\});

function log(msg) \{
    $('#log').append(msg + "\n");
\}

function loadViewDone(svg, error) \{
    if(error) \{
	log('Failed: ' + error);
	svg.text(10, 20, error, \{fill: 'red'\});
	return;
    \}

    log('Searching charts...');
    var charts = new Array();
    $('rect[id^="so_"]', svg.root()).each(function() \{
	charts.push(this.id);
    \});
    log(' ' + charts.join(', '));
\}

{
    foreach my $id (sort keys %views) {
	my $view = $views{$id};
	
	$OUT .= "\$('#$id').svg(\{loadURL: 'views/$view', onLoad: loadViewDone\});\n";
    }
}
</script>
</html>
